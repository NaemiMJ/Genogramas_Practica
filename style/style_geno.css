:root{
  --azul: #2c3e50;
  --rojo: #c0392b;
  --bg: #f4f7fa;
}

* { box-sizing: border-box; }

body{
  font-family: Arial, Helvetica, sans-serif;
  background: var(--bg);
  color: #222;
  margin: 18px;
}

/* Header */
h1 {
  text-align: center;
  color: #333;
}

/* Formulario paciente (principal) */
.form-wrapper {
  background: #fff;
  padding: 14px;
  border-radius: 8px;
  max-width: 420px;
  margin: 8px auto;
  box-shadow: 0 2px 8px rgba(0,0,0,0.08);
}
.form-wrapper label {
  display:block;
  margin: 8px 0;
  font-size: 14px;
}
.form-wrapper input, .form-wrapper select {
  margin-left: 6px;
  padding: 6px;
  font-size: 13px;
}

/* =========================================
   GENOGRAMA LAYOUT - VERSIÓN CORREGIDA
   ========================================= */

/* 1. Contenedor con Scroll: Permite movernos si el gráfico es muy ancho */
.genograma-container {
    position: relative;
    width: 100%;
    height: calc(100vh - 100px); /* Ocupa la pantalla menos el header */
    overflow: auto; /* Scroll automático vertical y horizontal */
    padding: 50px;  /* Margen interno para que no quede pegado */
    text-align: center; /* Ayuda al centrado inicial */
}

#conexiones {
  position: absolute;
  top: 0; left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  z-index: 1; /* Debajo de las personas */
}

/* 2. El lienzo que crece infinitamente */
.genograma {
    position: relative;
    display: inline-block; /* CLAVE: Permite crecer a lo ancho sin límite */
    min-width: 100%;       /* Mínimo el ancho de pantalla */
    width: max-content;    /* Se ensancha tanto como necesiten las personas */
    margin: 0 auto;
    z-index: 2;
}

/* 3. Filas Flexibles */
.fila {
    display: flex;
    align-items: center;
    justify-content: center; /* Centrado inicial */
    gap: 40px;
    margin-bottom: 60px;     /* Espacio vertical entre generaciones */
    width: 100%;
}

/* 4. BLOQUEO DE ENCOGIMIENTO (Anti-Aplastamiento) 
   Esto asegura que NINGÚN elemento se haga más pequeño de lo que necesita.
   Usamos !important para sobrescribir cualquier residuo. */
.fila > div, 
.pareja-slot, 
.center-block, 
.hermanos, 
.paciente-slot,
.persona,
.parent-slot {
    flex-shrink: 0 !important; 
}

/* Slots específicos ajustados */
.padres { 
  justify-content: center; 
  gap: 80px; /* Separación entre padre y madre */
}

.parent-slot { 
  width: 150px; 
  height: 120px; 
  display: flex; 
  align-items: center; 
  justify-content: center; 
}

.paciente-slot { 
  display: flex; 
  align-items: center; 
  justify-content: center; 
  width: 150px; 
  min-width: 150px; 
  min-height: 150px; 
}

.hermanos { 
  display: flex; 
  gap: 20px; 
  align-items: center; 
  justify-content: center; 
}

.center-block { 
  display: flex; 
  align-items: center; 
  gap: 20px; 
}

.hijos { 
  gap: 30px; 
  justify-content: center; 
  /* flex-wrap: wrap; <--- QUITADO: Mejor que crezca a lo ancho que saltar de línea */
}

/* --- PAREJAS (FIX PRINCIPAL) --- */
.pareja-slot {
    display: flex;
    align-items: center;
    width: auto !important; /* Deja que crezca según cuántas parejas haya */
    min-width: 50px;
    gap: 30px; /* Espacio entre ex-parejas */
}

/* Alineación específica de parejas */
#partner-left-slot {
    justify-content: flex-end; /* Empuja contenido hacia el paciente */
    padding-right: 20px;
}

#partner-right-slot {
    justify-content: flex-start; /* Empuja contenido hacia el paciente */
    padding-left: 20px;
}

/* Corrección visual para alineación */
.middle-row {
    margin-bottom: 60px; 
}


/* =========================================
   DISEÑO VISUAL (PERSONAS, SÍMBOLOS, ETC)
   ========================================= */

/* persona (figuras) */
.persona {
  position: relative;
  width: 100px;
  height: 100px;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  background: #fff;
  cursor: pointer;
  padding: 6px;
  z-index: 4;
}

/* colores y formas base */
.persona.hombre {
  --c: var(--azul);
  border: 4px solid var(--c);
  border-radius: 8px;
}
.persona.mujer {
  --c: var(--rojo);
  border: 4px solid var(--c);
  border-radius: 50%;
}

/* --- TEXTO GLOBAL (Siempre legible) --- */
.persona .nombre, .persona .edad {
  position: relative;
  z-index: 10; /* Siempre encima de iconos, X o patrones */
  text-align: center;
  background-color: rgba(255, 255, 255, 0.85); 
  padding: 1px 4px;      
  border-radius: 4px;    
  box-shadow: 0 0 3px rgba(0,0,0,0.1); 
}

.persona .nombre { 
  font-weight: 700; 
  font-size: 13px; 
  line-height: 1.1; 
}

.persona .edad { 
  font-size: 12px; 
  color: #333; 
  margin-top: 2px; 
}

/* Figura interior que marca "paciente" (doble contorno) */
.persona.paciente::after{
  content: "";
  position: absolute;
  z-index: 2;
  top: 14px; left: 14px; right: 14px; bottom: 14px;
  border: 3px solid var(--c);
  pointer-events: none;
  border-radius: 8px;
}
/* si paciente y mujer -> inner circle */
.persona.paciente.mujer::after { border-radius: 50%; }

/* --- ESTILO FALLECIDO (La X) --- */
.persona.fallecido::before {
  content: "";
  position: absolute;
  top: 0; left: 0; width: 100%; height: 100%;
  border-radius: inherit; 
  pointer-events: none;
  z-index: 5; 
  background: 
    linear-gradient(to top right, transparent calc(50% - 2px), var(--c) calc(50% - 1px), var(--c) calc(50% + 1px), transparent calc(50% + 2px)),
    linear-gradient(to bottom right, transparent calc(50% - 2px), var(--c) calc(50% - 1px), var(--c) calc(50% + 1px), transparent calc(50% + 2px));
  background-size: 100% 100%;
  background-repeat: no-repeat;
}

/* --- PATRONES DE ABUSO Y SALUD MENTAL --- */
.persona.patron-abuso {
  background: linear-gradient(to bottom, #fff 50%, #000 50%);
}
.persona.patron-sospecha {
  background: 
    linear-gradient(to bottom, #fff 50%, transparent 50%),
    repeating-linear-gradient(-45deg, #000, #000 2px, transparent 2px, transparent 6px);
}
.persona.patron-mental {
  background: linear-gradient(to right, #000 50%, #fff 50%);
}
.persona.patron-ambos {
  background: 
    linear-gradient(to right, #000 50%, transparent 50%),
    linear-gradient(to bottom, transparent 50%, #000 50%),
    #fff;
}
.persona.patron-ingreso {
  background: 
    linear-gradient(to bottom, #fff 50%, transparent 50%),
    linear-gradient(to right, #000 50%, #fff 50%);
}

/* --- SÍMBOLO LGTBIQ+ --- */
.persona.lgtb .simbolo-lgtb {
  position: absolute;
  top: 50%; left: 50%;
  transform: translate(-50%, -50%);
  z-index: 6; 
  width: 0; height: 0;
  border-left: 28px solid transparent;  
  border-right: 28px solid transparent; 
  border-top: 45px solid var(--c);      
}
.persona.lgtb .simbolo-lgtb::after {
  content: "";
  position: absolute;
  top: -41px; left: -22px;  
  width: 0; height: 0; 
  border-left: 22px solid transparent; 
  border-right: 22px solid transparent; 
  border-top: 35px solid #fff;          
}

/* --- EMBARAZO --- */
.persona.embarazo {
  width: 44px; height: 40px;
  background: transparent;
  border: none; border-radius: 0;
  position: relative;
}
.persona.embarazo::after {
  content: ""; 
  position: absolute; 
  top: 40%; left: 50%;
  transform: translate(-50%, -50%);
  z-index: 1;
  width: 0; height: 0;
  border-left: 22px solid transparent; 
  border-right: 22px solid transparent; 
  border-bottom: 40px solid var(--c); 
}
.persona.embarazo::before {
  content: ""; 
  position: absolute; 
  top: 40%; left: 50%;
  transform: translate(-50%, -42%);
  z-index: 2;
  width: 0; height: 0;
  border-left: 17px solid transparent; 
  border-right: 17px solid transparent; 
  border-bottom: 32px solid #fff;
}

/* 2. Aborto Espontáneo (Punto Negro) */
.persona.aborto-esp {
  width: 30px; 
  height: 30px; 
  background: #000; 
  border-radius: 50%; /* Siempre círculo */
  border: none;
}

/* 3. Aborto Provocado (X pequeña sola) */
.persona.aborto-prov {
  width: 30px; height: 30px; 
  background: transparent; 
  border: none;
}
.persona.aborto-prov::before, .persona.aborto-prov::after {
  content: ""; position: absolute; 
  top: 0; left: 13px; /* Centrado aproximado */
  width: 4px; height: 30px; 
  background: #000;
}
.persona.aborto-prov::before { transform: rotate(45deg); }
.persona.aborto-prov::after { transform: rotate(-45deg); }

/* --- NEONATO MUERTO --- */
.persona.neonato-x {
  width: 40px; height: 40px;
  border: 2px solid var(--c); 
  display: flex; align-items: center; justify-content: center;
  background: #fff;
  overflow: hidden;
}
.persona.neonato-x::before {
  content: ""; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
  background: 
    linear-gradient(to top right, transparent calc(50% - 1px), var(--c) calc(50% - 0.5px), var(--c) calc(50% + 0.5px), transparent calc(50% + 1px)),
    linear-gradient(to bottom right, transparent calc(50% - 1px), var(--c) calc(50% - 0.5px), var(--c) calc(50% + 0.5px), transparent calc(50% + 1px));
}
.persona.neonato-x.mujer { border-radius: 50%; }
.persona.neonato-x.hombre { border-radius: 0; }

/* menú contextual */
.menu-acciones {
  position: absolute;
  background: #fff;
  border: 1px solid #cfcfcf;
  padding: 8px;
  border-radius: 8px;
  box-shadow: 0 6px 18px rgba(0,0,0,0.12);
  z-index: 40;
}
.menu-acciones button {
  display:block;
  width: 100%;
  margin: 6px 0;
  padding: 6px 8px;
  background: #3498db;
  color: #fff;
  border: none;
  border-radius: 6px;
  cursor: pointer;
}
.menu-acciones button:hover { background:#2b7cb0; }

/* modal compacto */
.modal {
  position: fixed;
  left: 50%; top: 50%;
  transform: translate(-50%,-50%);
  z-index: 60;
  width: 320px;
}
.modal-inner {
  background: #fff;
  border-radius: 10px;
  padding: 12px;
  box-shadow: 0 10px 30px rgba(0,0,0,0.16);
}
.modal-inner h4 { margin: 4px 0 8px 0; }
.modal-inner label { display:block; margin:6px 0; font-size: 13px; }
.modal-inner input, .modal-inner select { margin-left:8px; padding:6px; font-size:13px; }
.modal-actions { display:flex; gap:8px; justify-content:flex-end; margin-top:8px; }
.modal-actions button { padding:6px 10px; border-radius:6px; border:none; cursor:pointer; }
.modal-actions button:first-child { background:#2ecc71; color:white; }
.modal-actions button:last-child { background:#e74c3c; color:white; }

/* utilidades */
.oculto { display:none; }

/* responsivo pequeño */
@media (max-width:600px) {
  .parent-slot, .paciente-slot { width:120px; height:120px; }
  .persona { width:82px; height:82px; }
  .persona.paciente::after { top:10px; left:10px; right:10px; bottom:10px; }
}

/* En tu CSS */
.child-group {
  display: inline-flex;
  flex-direction: row;
  align-items: flex-start;
  justify-content: center;
  gap: 20px;
  margin: 0 15px;
}